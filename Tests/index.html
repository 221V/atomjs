<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<link href="qunit.css" rel="stylesheet" />
		<script src="jquery.js"></script>
		<script src="qunit.js"></script>
		<!-- Connect AtomJS framework here -->
		<script src="atom.js"></script>
	</head>
	<body>
		<h1 id="qunit-header">Atom Javascript framework tests</h1>
		<h2 id="qunit-banner"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">
			<code>ccc</code>
			<h1>The standard Lorem Ipsum passage, used since the 1500s</h1>
			<p>"Lorem ipsum dolor sit <a class="foo" href="#">amet</a>, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
			<h1>Section 1.10.32 of "de Finibus Bonorum et Malorum", written by Cicero in 45 BC</h1>
			<p>"Sed ut perspiciatis unde <a title="test" href="#">omnis</a> iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"</p>
			<h1>1914 translation by H. Rackham</h1>
			<p>"But I must explain to you how all this mistaken idea of denouncing <em title="test-em">pleasure</em> and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?"</p>
			<h1>Section 1.10.33 of "de Finibus Bonorum et Malorum", written by Cicero in 45 BC</h1>
			<p>"At vero eos et accusamus <a href="#">et iusto odio</a> dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat."</p>
			<h1>1914 <a href="#">translation</a> by H. Rackham</h1>
			<p>"On the other hand, we denounce with righteous indignation and dislike men who are so beguiled and demoralized by the charms of pleasure of the moment, so blinded by desire, that they cannot foresee the pain and trouble that are bound to ensue; and equal blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil and pain. These cases are perfectly simple and easy to distinguish. In a free hour, when our power of choice is untrammelled and when nothing prevents our being able to do what we like best, every pleasure is to be welcomed and every pain avoided. But in certain circumstances and owing to the claims of duty or the obligations of business it will frequently occur that pleasures have to be repudiated and annoyances accepted. The wise man therefore always holds in these matters to this principle of selection: he rejects pleasures to secure other greater pleasures, or else he endures pains to avoid worse pains."</p>
		</div>
	</body>
	<script>
jQuery(function(){
	
var undefined;
	/******************************************
	 * [Atom Core]
	 ******************************************/
module('[Atom Core]');

test('Initialize', function(){
	ok( atom, 'atom' );
	ok( atom.isAtom(atom()), 'atom.isAtom(atom())' );
});
test('JavaScript 1.8.5 Compatiblity', function(){
	equal( typeof (function(){}.bind) , 'function', 'typeof function(){}.bind' );
	equal( typeof Object.keys  , 'function', 'typeof Object.keys' );
	equal( typeof Array.isArray, 'function', 'typeof Array.isArray' );

	ok(  Array.isArray([]), ' Array.isArray([])' );
	ok( !Array.isArray({}), '!Array.isArray({})' );

	deepEqual( Object.keys({a:1,b:2,3:3}), ['a','b','3'], 'Object.keys({a:1,b:2,3:3})' );
});
test('atom.typeOf', function(){
	equal( atom.typeOf(document.body), 'element'  , 'atom.typeOf(document.body)');
	equal( atom.typeOf(function(){}) , 'function' , 'atom.typeOf(function(){})');
	equal( atom.typeOf(new Date())   , 'date'     , 'atom.typeOf(new Date())');
	equal( atom.typeOf(null)     , 'null'     , 'atom.typeOf(null)');
	equal( atom.typeOf(atom())   , 'atom'     , 'atom.typeOf(atom())');
	equal( atom.typeOf(arguments), 'arguments', 'atom.typeOf(arguments)');
	equal( atom.typeOf(/abc/i)   , 'regexp'   , 'atom.typeOf(/abc/i)');
	equal( atom.typeOf([])       , 'array'    , 'atom.typeOf([])');
	equal( atom.typeOf({})       , 'object'   , 'atom.typeOf({})');
	equal( atom.typeOf(15)       , 'number'   , 'atom.typeOf(15)');
	equal( atom.typeOf(true)     , 'boolean'  , 'atom.typeOf(true)');
});
test('atom.clone', function(){
	// array cloning
	var mixed, object, array, clone;
	array = [1,2,3,[4,5]];
	clone = atom.clone(array);
	notStrictEqual(clone, array, 'array !== clone');
	deepEqual(clone, array, 'clone is same to array');
	clone[4] = 'changed';
	notDeepEqual(clone, array, 'clone is changed');

	// hash cloning
	object = {a:'2', b:'3', array: [1,2,3], object: {foo:'bar'}};
	clone = atom.clone(object);
	notStrictEqual(clone, object, 'object !== clone');
	deepEqual(clone, object, 'clone is same to object');
	clone['prop'] = 'changed';
	notDeepEqual(clone, object, 'clone is changed');

	// object cloning
	var Foo = function (name) { this.name = name; };
	var Bar = function (name) {
		this.name = name;
		this.clone = function () {
			return new Bar('clone of ' + this.name);
		};
	};

	object = {foo: new Foo('fooName'), bar: new Bar('barName')};
	clone  = atom.clone(object);
	notStrictEqual(object.bar, clone.bar, 'Objects with "clone" - cloning');
	equal(clone.bar.name, 'clone of barName', 'Objects with "clone" - cloning');

	// todo: [qtest] accessors
});


// todo: [qtest] atom.merge
test('atom.(extend/implement)', function(){
	atom.extend({
		get testProp() { return 'testPropValue:static'; },
		testMethod: function () { return 'testMethodValue:static'; }
	}).implement({
		get testProp() { return 'testPropValue'; },
		testMethod: function () { return 'testMethodValue'; }
	});
	equal(atom.testProp,     'testPropValue:static'  , 'atom.extend getter');
	equal(atom.testMethod(), 'testMethodValue:static', 'atom.extend method');
	equal(atom().testProp,     'testPropValue'  , 'atom.implement getter');
	equal(atom().testMethod(), 'testMethodValue', 'atom.implement method');

	var testObject = { prop : 'Yes' };
	atom.extend(testObject, 'safe', { prop : 'No' });
	equal(testObject.prop, 'Yes', 'atom safe extend');
});

	/******************************************
	 * [Atom Plugins] Dom
	 ******************************************/

module('[Atom Plugins] Dom');

test('Get', function(){
	var ID = 'qunit-fixture', $ID = '#' + ID,
		win = window, doc = win.document,
		getElement = 'getElement',
		byId = getElement + 'ById',
		byTag = getElement + 'sByTagName',
		byClass = getElement + 'sByClassName',
		wrapper = doc[byId](ID);
	
	strictEqual(atom().get(), doc, 'atom() is document');
	strictEqual(atom('unknownTag').length, 0, 'atom("unknownTag") returns nothing');
	strictEqual(atom($ID + ' p').length , wrapper[byTag]('p').length    , 'atom("#cid p") right length');
	strictEqual(atom('.foo', $ID).length, wrapper[byClass]('foo').length, 'atom(".foo", "#cid") right length');
	// todo: [qtest] full of DOM plugin
});

	/******************************************
	 * [Atom Plugins] Types
	 ******************************************/

module('[Atom Plugins] Types');

test('Function', function(){
	equals(Function.lambda('Foo')(), 'Foo', 'Function.lambda');
	equals(function(bar, quz) {
		return this.foo + bar + quz;
	}.context({ foo: 'Foo'}, ['Bar'])('Quz'), 'FooBarQuz', 'function.context');

	// todo: [qtest] function.delay
	// todo: [qtest] function.periodical
});

test('Number', function(){
	ok(Number.random(150, 200).between(150, 200, true), 'Number.random in right range');

	// between
	ok( (50).between(20, 80),       ' (50).between(20, 80)');
	ok(!(20).between(20, 80),       '!(20).between(20, 80)');
	ok(!( 0).between(20, 80),       '!( 0).between(20, 80)');
	ok( (20).between(20, 80, true), ' (20).between(20, 80, true)');
	ok(!(20).between(20, 80, 'R'),  '!(20).between(20, 80, "R")');
	ok( (20).between(20, 80, 'L'),  ' (20).between(20, 80, "L")');
	ok( (20).between(20, 80, 'LR'), ' (20).between(20, 80, "LR")');
	ok( (80).between(20, 80, true), ' (80).between(20, 80, true)');
	ok( (80).between(20, 80, 'R'),  ' (80).between(20, 80, "R")');
	ok(!(80).between(20, 80, 'L'),  '!(80).between(20, 80, "L")');
	ok( (80).between(20, 80, 'LR'), ' (80).between(20, 80, "LR")');

	// equals
	ok( (5).equals(5), '(5).equals(5)' );
	ok(!(7).equals(5), '(7).equals(5)' );
	notEqual( (0.7+0.1)*10, 8, '(0.7+0.1)*10 != 8' );
	ok( ((0.7+0.1)*10).equals(8), '(0.7+0.1)*10.equals(8)' );
	ok( (0.123456).equals(0.123456),    ' (0.123456).equals(0.123456)' );
	ok(!(0.123456).equals(0.123457),    '!(0.123456).equals(0.123457)' );
	ok( (0.123456).equals(0.123457, 4), ' (0.123456).equals(0.123457, 4)' );

	// limit
	equal((50).limit(20, 80), 50, '(50).limit(20, 80) == 50');
	equal((10).limit(20, 80), 20, '(10).limit(20, 80) == 20');
	equal((90).limit(20, 80), 80, '(90).limit(20, 80) == 80');

	// todo: [qtest] number.round(value)
	equal((15.234).round(), 15, '(15.234).round() == 15');

	// todo: [qtest] number.toFloat
	// todo: [qtest] number.toInt
	// todo: [qtest] number.stop

	// todo: [qtest] number.Math
});

test('String', function(){
	// todo: [qtest] string.safehtml

	// repeat
	equal('ab-'.repeat(3), 'ab-ab-ab-', 'String.repeat');

	// repeat
	equal('result is {here}!'.substitute({ here: 123 }), 'result is 123!', 'String.substitute');

	// replaceAll
	equal('Repl/ace /all "/a"'.replaceAll('/a', '0'), 'Repl0ce 0ll "0"', 'String.replaceAll');

	// begins
	ok( 'String'.begins('Str'), 'String.begins("Str")');
	ok(!'String'.begins('ing'), 'String.begins("ing")');

	// [ul]cfirst
	equal( 'string'.ucfirst(), 'String', 'String.ucfirst');
	equal( 'STRING'.lcfirst(), 'sTRING', 'String.lcfirst');
});

test('Array', function(){
	/** Static **/

	// todo: [qtest] Array.pickFrom
	deepEqual(Array.range(5, 9),    [5,6,7,8,9], 'Array.range(5, 9)');
	deepEqual(Array.range(5, 9, 2), [5,  7,  9], 'Array.range(5, 9, 2)');
	deepEqual(Array.fill(5, 8),     [8,8,8,8,8], 'Array.fill(5,8)');
	deepEqual(Array.collect({a:1, b:2, c:3}, ['a','b','z'], 9), [1,2,9], 'Array.collect');

	/** Dynamic **/
	// Contains
	ok( [1,2,3,4].contains(3), ' [1,2,3,4].contains(3)' );
	ok(![1,2,3,4].contains(0), '![1,2,3,4].contains(0)' );

	// include
	deepEqual([1,2,3].include(4), [1,2,3,4], '[1,2,3].include(4)');
	deepEqual([1,2,3].include(3), [1,2,3  ], '[1,2,3].include(3)');

	deepEqual([1,2,3].append([2,3,4]), [1,2,3,2,3,4], '[1,2,3].append([2,3,4])');
	deepEqual([1,2,3].append([2,3,4], [5,6,7]), [1,2,3,2,3,4,5,6,7], '[1,2,3].append([2,3,4],[5,6,7])');

	// erase
	deepEqual([1,2,3,1,2,3].erase(2), [1,3,1,3], 'array.erase');
	// toKeys
	deepEqual(['a','b','c'].toKeys( ), {a:0, b:1, c:2}, 'array.toKeys()');
	deepEqual(['a','b','c'].toKeys(9), {a:9, b:9, c:9}, 'array.toKeys(value)');

	// combine
	deepEqual([1,2,3].combine([2,3,4]), [1,2,3,4], 'array.combine');

	// last
	equal([6,7,8,9].last(), 9, 'array.last');

	// random
	ok([6,7,8,9].random().between(6, 9, true), 'array.random');

	strictEqual([false, null,  1, undefined].pick(),   1, 'array.pick');
	strictEqual([false, null,  0, undefined].pick(),   0, 'array.pick');
	strictEqual([false, null, '', undefined].pick(), null, 'array.pick');

	deepEqual([
		function (x) { return x * this.i * 0; },
		function (x) { return x * this.i * 1; },
		function (x) { return x * this.i * 2; },
		function (x) { return x * this.i * 3; },
	].invoke({i : 2}, 5), [0, 10, 20, 30], 'array.invoke');
	// todo: [qtest] array.shuffle
	// todo: [qtest] array.sortBy
	equal([4, 1, 8, 13, 8].min(),  1, 'array.min');
	equal([4, 1, 8, 13, 8].max(), 13, 'array.max');
	equal([1, 2, 3, 4, 5].sum(),  15, 'array.sum');
	equal([1, 2, 3, 4, 5].average(), 3, 'array.average');
	deepEqual([1, 2, 1, 2, 1, 2].unique(), [1,2], 'array.unique');
	// todo: [qtest] array.associate
	deepEqual([1,2,0,null,'string'].clean(), [1,2,'string'], 'array.unique');
	deepEqual([1,2,3].empty(), [], 'array.empty');
	deepEqual([1,2,3].clone(), [1,2,3], 'array.clone() result is similar to array');
	notStrictEqual([1,2,3].clone(), [1,2,3], 'array.clone() result not equals to array');

	// todo: [qtest] array.hexToRgb
	// todo: [qtest] array.rgbToHex
});

test('Object', function(){
	deepEqual(Object.invert({ a:'x', b:'y', c:'z'  }), { x:'a', y: 'b', z: 'c'}, 'Object.invert');
	deepEqual(Object.collect({ a:'x', b:'y', c:'z' }, ['a','b','k'], 5), { a:'x', b:'y', k:5}, 'Object.collect');

	ok( Object.isDefined(42), 'Object.isDefinded(42)');
	ok(!Object.isDefined(undefined), 'Object.isDefinded(undefined)');

	ok( Object.isReal(  42), 'Object.isReal(42)');
	ok( Object.isReal(   0), 'Object.isReal(0)');
	ok(!Object.isReal(null), 'Object.isReal(null)');

	// todo: [qtest] Object.deepEquals
});


module('[Atom Plugins] Class');

test('Creating', function(){
	var Clonable = atom.Class({
		initialize: function(name) { this.name = name; },
		clone: function() { return new Clonable('cloneName'); }
	});

	var Plain = atom.Class({
		initialize: function(name) { this.name = name; }
	});

	var Foo = atom.Class({
		name: null,
		initialize: function (name) { this.name = name; },

		obj : {
			prop: {}
		},
		
		property: 0,
		setProperty: function(property) { this.property = property; },
		getProperty: function() { return this.property; },

		_etter: 0,
		set etter(etter) { this._etter = etter * 2; },
		get etter() { return this._etter + 5; },

		array: ['first'],
		plain: new Plain('plainName'),
		object: { name:'objectName' },
		clonable: new Clonable('clonableName')
	});

	var foo = new Foo('fooName');
	var bar = new Foo('barName');

	// instance
	equal(typeof foo, 'object', 'typeof foo == "object"');
	ok(foo instanceof Foo, 'foo instanceof Foo');

	// methods
	equal(foo.name, 'fooName', 'Foo.initialize');

	equal(foo.property, 0, 'Foo.property default value');
	equal(foo.getProperty(), 0, 'Foo.getProperty() default value');
	foo.setProperty(7);
	equal(foo.property, 7, 'Foo.property new value');
	equal(foo.getProperty(), 7, 'Foo.getProperty() new value');

	// getters/setters
	foo.etter = 9;
	equal(foo._etter, 18, 'Property setter');
	equal(foo.etter, 23, 'Property getter');

	// objects cloning
	equal(foo.array[0], 'first', 'foo.array default value');
	equal(foo.plain.name, 'plainName', 'foo.plain default value');
	equal(foo.object.name, 'objectName', 'foo.object default value');
	equal(foo.clonable.name, 'cloneName', 'foo.clonable default value');
	// ok(foo.plain instanceof Plain, 'foo.plain instanceof Plain'); // how ? important?
	ok(foo.clonable instanceof Clonable, 'foo.clonable instanceof Clonable');

	// object are independent
	var secondFoo = new Foo();
	secondFoo.array[0] = 'secondFoo.array';
	secondFoo.plain.name = 'secondFoo.plain';
	secondFoo.object.name = 'secondFoo.object';
	secondFoo.clonable.name = 'secondFoo.clonable';

	equal(foo.array[0], 'first', 'foo.array without changes');
	equal(foo.plain.name, 'plainName', 'foo.plain without changes');
	equal(foo.object.name, 'objectName', 'foo.object without changes');
	equal(foo.clonable.name, 'cloneName', 'foo.clonable without changes');

	notEqual(foo.obj.prop, bar.obj.prop, 'Objects are cloned');
});

test('Extending', function(){
	var Foo = atom.Class({
		name: null,
		initialize: function (name) { this.name = name; },

		property: 0,
		setProperty: function(property) { this.property = property; },
		getProperty: function() { return this.property; },

		_etter: 0,
		set etter(etter) { this._etter = etter * 2; },
		get etter() { return this._etter + 5; },

		fooProperty: 21,
		setFooProperty: function(fooProperty) { this.fooProperty = fooProperty; },
		getFooProperty: function() { return this.fooProperty; },

		parentProperty: 1,
		setParentProperty: function(parentProperty) { this.parentProperty = parentProperty; },
		getParentProperty: function() { return this.parentProperty; },

		_parentSetterTest: 0,
		set parentSetterTest(value) { this._parentSetterTest = value * 2; },
		get parentSetterTest() { return this._parentSetterTest * 3; } 
	});

	var Bar = atom.Class({
		Extends: Foo,

		// test overload
		setProperty: function(property) { this.property = property * 2; },
		getProperty: function() { return this.property + 2; },

		// test independent properties
		barProperty: 0,
		setBarProperty: function(fooProperty) { this.barProperty = fooProperty; },
		getBarProperty: function() { return this.barProperty; },

		// test calling "parent" function
		setParentProperty: function(parentProperty) { this.parent(parentProperty + 3); },
		getParentProperty: function() { return this.parent() + 4; }
		
		// set parentSetterTest(value) { this.parent(value + 5); },
		// get parentSetterTest() { return this.parent() * 5; } 
	});

	var Qux = atom.Class({
		Extends : Bar,
		initialize: function (name) { this.parent(name) },
		setParentProperty: function(parentProperty) { this.parent(parentProperty + 3); },
		getParentProperty: function() { return this.parent() + 4; }
	});


	var foo = new Foo('fooName');
	var bar = new Bar('barName');
	var qux = new Qux('quxName');

	// instanceof
	ok(  foo instanceof Foo , '  foo instanceof Foo');
	ok(!(foo instanceof Bar), '!(foo instanceof Bar)');
	ok(!(foo instanceof Qux), '!(foo instanceof Qux)');
	ok(  bar instanceof Foo , '  bar instanceof Foo');
	ok(  bar instanceof Bar , '  bar instanceof Bar');
	ok(!(bar instanceof Qux), '!(bar instanceof Qux)');
	ok(  qux instanceof Foo , '  qux instanceof Foo');
	ok(  qux instanceof Bar , '  qux instanceof Bar');
	ok(  qux instanceof Qux , '  qux instanceof Qux');

	// methods
	equal(foo.name, 'fooName', 'Foo.initialize');
	equal(bar.name, 'barName', 'Bar.initialize');
	equal(qux.name, 'quxName', 'Qux.initialize');

	// Same in Foo
	equal(foo.property, 0, 'Foo.property default value');
	equal(foo.getProperty(), 0, 'Foo.getProperty() default value');
	foo.setProperty(7);
	equal(foo.property, 7, 'Foo.property new value');
	equal(foo.getProperty(), 7, 'Foo.getProperty() new value');

	// overloaded in Bar
	equal(bar.property, 0, 'Bar.property default value');
	equal(bar.getProperty(), 2, 'Bar.getProperty() overloaded');
	bar.setProperty(7);
	equal(bar.property, 14, 'Bar.property new value (overloaded)');
	equal(bar.getProperty(), 16, 'Bar.getProperty() new value (overloaded)');

	// Mathod "parent"
	equal(bar.parentProperty, 1, 'Bar.parentProperty default value');
	equal(bar.getParentProperty(), 5, 'Bar.getParentProperty() overloaded');
	bar.setParentProperty(7);
	equal(bar.parentProperty, 10, 'Bar.parentProperty new value (overloaded)');
	equal(bar.getParentProperty(), 14, 'Bar.getParentProperty() new value (overloaded)');

	// chain of .parent
	equal(qux.parentProperty, 1, 'Qux.parentProperty default value');
	equal(qux.getParentProperty(), 9, 'Qux.getParentProperty() overloaded');
	qux.setParentProperty(7);
	equal(qux.parentProperty, 13, 'Qux.parentProperty new value (overloaded)');
	equal(qux.getParentProperty(), 21, 'Qux.getParentProperty() new value (overloaded)');

	// parent of parent method
	equal(qux.fooProperty, 21, 'parent of parent method');

	// Setters/getters
	bar.etter = 9;
	equal(bar._etter, 18, 'Property setter is implemented');
	equal(bar.etter,  23, 'Property getter is implemented');
	// Maybe in future ?
	// bar.parentSetterTest = 2;
	// equal(bar._parentSetterTest, 14, 'setter is overloaded and called from child');
	// equal(bar.parentSetterTest, 210, 'getter is overloaded and called from child');

});

test('Factory', function(){
	var Foo = atom.Class({
		firstname: null,
		lastname : null,
		initialize: function (firstname, lastname) {
			this.firstname = firstname;
			this.lastname  = lastname;
		}
	});

	var Bar = atom.Class({
		Extends: Foo,
		surname : null,
		initialize: function (firstname, lastname, surname) {
			this.parent(firstname, lastname);
			this.surname = surname;
		}
	});

	var foo = Foo.factory(['fooFN', 'fooLN']);
	var bar = Bar.factory(['barFN', 'barLN', 'barSN']);

	// instanceof
	ok(  foo instanceof Foo , '  foo instanceof Foo');
	ok(!(foo instanceof Bar), '!(foo instanceof Bar)');
	ok(  bar instanceof Foo , '  bar instanceof Foo');
	ok(  bar instanceof Bar , '  bar instanceof Bar');

	equals(foo.firstname, 'fooFN', 'foo.firstname')
	equals(foo.lastname , 'fooLN', 'foo.lastname')
	equals(bar.firstname, 'barFN', 'bar.firstname')
	equals(bar.lastname , 'barLN', 'bar.lastname')
	equals(bar.surname  , 'barSN', 'bar.surname')
});

test('Static', function(){
	var Foo = atom.Class({
		Static: {
			fooStat: 'fooStatValue',
			qweStat: 'qweStatValue'
		}
	});

	var Bar = atom.Class({
		Extends: Foo,
		Static: {
			qweStat: 'qweStat[Bar]',
			barStat: 'barStatValue'
		}
	});

	var foo = new Foo();
	var bar = new Bar();

	equal(foo.self.fooStat, 'fooStatValue', 'foo.self.fooStat');
	equal(foo.self.qweStat, 'qweStatValue', 'foo.self.qweStat');
	equal(foo.self.barStat,      undefined, 'foo.self.barStat');
	equal(bar.self.fooStat, 'fooStatValue', 'bar.self.fooStat');
	equal(bar.self.qweStat, 'qweStat[Bar]', 'bar.self.qweStat');
	equal(bar.self.barStat, 'barStatValue', 'bar.self.barStat');
});

module('[Atom Plugins] Class Events');

test('Events', function(){
	// todo: write tests.
	expect(2);

	var Eventable = atom.Class({
		Implements: [atom.Class.Events]
	});

	var eventable = new Eventable();

	eventable.addEvent('foo', function (arg) {
		ok(true, 'Event fired!');
		equal(arg, 'bar', 'Argument is correct!');
	});

	eventable.fireEvent('foo', ['bar']);

});

module('[Atom Plugins] Uri');

var testUri = function (uri, tests) {
	// based on http://stevenlevithan.com/demo/parseuri/js/

	var parse = atom.uri(uri);

	for (prop in tests) if (prop != 'queryKey') {
		equal(parse[prop], tests[prop], prop);
	}


	if ('queryKey' in tests) deepEqual(parse.queryKey, tests.queryKey, 'queryKey');
};

test('Full path', function(){
	var uri = 'http://usr:pwd@www.example.com:81/dir/dir.2/index.htm?q1=0&&test1&test2=value#top';
	testUri( uri, {
		anchor: 'top',
		query: 'q1=0&&test1&test2=value',
		file: 'index.htm',
		directory: '/dir/dir.2/',
		path: '/dir/dir.2/index.htm',
		relative: '/dir/dir.2/index.htm?q1=0&&test1&test2=value#top',
		port: '81',
		host: 'www.example.com',
		password: 'pwd',
		user: 'usr',
		userInfo: 'usr:pwd',
		authority: 'usr:pwd@www.example.com:81',
		protocol: 'http',
		source: uri,
		queryKey: {
			q1: '0',
			test1: '',
			test2: 'value'
		}
	});
});

test('Relative path', function(){
	var uri = '/dir/dir.2/index.htm?q1=0&&test1&test2=value#top';
	testUri( uri, {
		anchor: 'top',
		query: 'q1=0&&test1&test2=value',
		file: 'index.htm',
		directory: '/dir/dir.2/',
		path: '/dir/dir.2/index.htm',
		relative: '/dir/dir.2/index.htm?q1=0&&test1&test2=value#top',
		port: '',
		host: '',
		password: '',
		user: '',
		userInfo: '',
		authority: '',
		protocol: '',
		source: uri,
		queryKey: {
			q1: '0',
			test1: '',
			test2: 'value'
		}
	});
});

});
	</script>
</html>